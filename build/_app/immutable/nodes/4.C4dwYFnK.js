import"../chunks/CWj6FrbW.js";import"../chunks/C5NhBMmo.js";import{p as ge,y as _e,u as re,g as a,ag as je,a4 as R,a6 as o,a5 as S,a8 as n,a7 as m,a as fe,f as we,a9 as Ne,z as L,o as Se,A as de,w as te}from"../chunks/vtVjXRxL.js";import{s as j,d as Ve}from"../chunks/DtjsYg9O.js";import{i as O}from"../chunks/CXzoa0Vj.js";import{c as De,g as xe,r as X,e as se,i as ne}from"../chunks/Bdv8_l-1.js";import{f as p,a as c,c as Pe,t as ye}from"../chunks/BKrJ63KQ.js";import{i as Ie}from"../chunks/u0ba0zPQ.js";import{a as pe,s as me}from"../chunks/DOdqnhqz.js";import{B as Ee}from"../chunks/Bs-ooyg2.js";import{a as ke}from"../chunks/BP3o4HH5.js";import{p as ae}from"../chunks/kSd3V6n8.js";import{L as he}from"../chunks/CIVvI00M.js";import{b as Z,a as Fe}from"../chunks/B1SoyIIh.js";import{b as Je}from"../chunks/Dn7vSONY.js";class Te{constructor(){this.axios=De()}async getActions(){try{return[(await this.axios.get(`${ke()}/actions`,{headers:{...xe()}})).data.data,null]}catch(e){return[null,e]}}async invokeAction(e,F){try{const V=F.map(i=>{if(typeof i=="boolean")return i?"true":"false";if(typeof i=="object"&&i!==null)try{return JSON.stringify(i)}catch(k){return console.warn("Could not JSON stringify argument:",i,k),String(i)}return String(i)});return[(await this.axios.post(`${ke()}/actions/invoke`,{path:e,args:V},{headers:{...xe()}})).data.data,null]}catch(V){return[null,V]}}}const Ae=new Te;var Ue=p('<span class="arg-type svelte-1jugud0"> </span> <br/>',1),Be=p('<input type="text" class="input input-sm arg-input svelte-1jugud0"/>'),Me=p('<input type="number" class="input input-sm arg-input svelte-1jugud0" step="1"/>'),qe=p('<input type="number" class="input input-sm arg-input svelte-1jugud0" step="any"/>'),ze=p('<input type="checkbox" class="checkbox arg-input svelte-1jugud0"/>'),Ce=p('<input type="datetime-local" class="input input-sm arg-input svelte-1jugud0"/>'),He=p("<option> </option>"),Ke=p('<div class="duration-input-group svelte-1jugud0"><input type="number" class="input input-sm arg-input duration-number svelte-1jugud0" step="any"/> <select class="select select-sm arg-input duration-unit svelte-1jugud0"></select></div>'),Re=p('<input type="text" class="input input-sm arg-input svelte-1jugud0" placeholder="Unknown kind"/>'),Ge=p('<label class="arg-label svelte-1jugud0"><div><!> <span class="arg-type svelte-1jugud0"> </span></div> <!></label>');function Qe(G,e){ge(e,!0);const[F,V]=me(),v=()=>pe(he,"$LL",F);let i=ae(e,"value",15);const k=_e({nsec:{value:1,label:v().remote_actions.units.nsec()},Âµsec:{value:1e3,label:v().remote_actions.units.usec()},msec:{value:1e6,label:v().remote_actions.units.msec()},sec:{value:1e9,label:v().remote_actions.units.sec()},min:{value:60*1e9,label:v().remote_actions.units.min()},hour:{value:3600*1e9,label:v().remote_actions.units.hour()},day:{value:86400*1e9,label:v().remote_actions.units.day()},week:{value:7*86400*1e9,label:v().remote_actions.units.week()},month:{value:30*86400*1e9,label:v().remote_actions.units.month()},year:{value:365*86400*1e9,label:v().remote_actions.units.year()}}),J=Object.keys(k);function C(t,l){const _=k[l].value;return typeof t!="number"||isNaN(t)||!_?0:Math.round(t*_)}let h=R(0),y=R("sec"),u=je(()=>e.arg.kind==="duration");re(()=>{if(a(u)){const t=C(a(h),a(y));t!==i()&&i(t)}});var b=Ge(),d=o(b),w=o(d);{var U=t=>{var l=Ue(),_=we(l),A=o(_,!0);n(_),Ne(2),m(()=>j(A,e.arg.name)),c(t,l)};O(w,t=>{e.arg.name&&t(U)})}var Y=S(w,2),N=o(Y,!0);n(Y),n(d);var B=S(d,2);{var Q=t=>{var l=Be();X(l),m(()=>l.disabled=e.loading),Z(l,i),c(t,l)},W=(t,l)=>{{var _=g=>{var f=Me();X(f),m(()=>f.disabled=e.loading),Z(f,i),c(g,f)},A=(g,f)=>{{var M=P=>{var q=qe();X(q),m(()=>q.disabled=e.loading),Z(q,i),c(P,q)},D=(P,q)=>{{var ie=E=>{var H=ze();X(H),m(()=>H.disabled=e.loading),Fe(H,i),c(E,H)},le=(E,H)=>{{var oe=z=>{var K=Ce();X(K),m(()=>K.disabled=e.loading),Z(K,i),c(z,K)},ue=(z,K)=>{{var ce=s=>{var r=Ke(),x=o(r);X(x);var I=S(x,2);se(I,21,()=>J,ne,(T,$)=>{var ee=He(),be={},Oe=o(ee,!0);n(ee),m(()=>{be!==(be=a($))&&(ee.value=(ee.__value=a($))??""),j(Oe,k[a($)].label)}),c(T,ee)}),n(I),n(r),m(()=>{x.disabled=e.loading,I.disabled=e.loading}),Z(x,()=>a(h),T=>L(h,T)),Je(I,()=>a(y),T=>L(y,T)),c(s,r)},ve=s=>{var r=Re();X(r),m(()=>r.disabled=e.loading),Z(r,i),c(s,r)};O(z,s=>{e.arg.kind==="duration"?s(ce):s(ve,!1)},K)}};O(E,z=>{e.arg.kind==="time"?z(oe):z(ue,!1)},H)}};O(P,E=>{e.arg.kind==="bool"?E(ie):E(le,!1)},q)}};O(g,P=>{e.arg.kind==="float"||e.arg.kind==="float32"||e.arg.kind==="float64"?P(M):P(D,!1)},f)}};O(t,g=>{e.arg.kind==="int"||e.arg.kind==="int8"||e.arg.kind==="int16"||e.arg.kind==="int32"||e.arg.kind==="int64"||e.arg.kind==="uint"||e.arg.kind==="uint8"||e.arg.kind==="uint16"||e.arg.kind==="uint32"||e.arg.kind==="uint64"?g(_):g(A,!1)},l)}};O(B,t=>{e.arg.kind==="text"?t(Q):t(W,!1)})}n(b),m(()=>j(N,e.arg.type)),c(G,b),fe(),V()}async function We(G,e,F,V,v,i,k,J,C){var y;if(!a(e))return;L(F,!0),L(V,null),L(v,null);const h=a(i).args.map((u,b)=>{const d=k[b];return J(d,u.kind)});try{const[u,b]=await Ae.invokeAction(a(C),h);if(b)throw b;u&&u.error?L(v,u.error,!0):u?L(V,u.result,!0):L(v,"Received unexpected null response")}catch(u){L(v,((y=u.response)==null?void 0:y.data)||u.message||`Failed to invoke action '${a(C)}'`,!0)}finally{L(F,!1)}}var Xe=p('<p class="action-description svelte-pelhnx"> </p>'),Ye=p('<div class="args-container svelte-pelhnx"></div>'),Ze=p('<p class="no-args-message svelte-pelhnx"> </p>'),$e=p('<div class="output-box error-display svelte-pelhnx"><pre class="svelte-pelhnx"> </pre></div>'),et=p('<div class="output-box result-box svelte-pelhnx"><pre class="svelte-pelhnx"> </pre></div>'),tt=p('<div class="action-node svelte-pelhnx"><div class="action-header svelte-pelhnx"><div class="action-icon svelte-pelhnx"><i class="fa-solid fa-circle-notch"></i></div> <span class="action-name svelte-pelhnx"> </span></div> <!> <div class="action-body svelte-pelhnx"><div class="input-row svelte-pelhnx"><!> <button class="btn btn-sm invoke-button variant-ghost-primary svelte-pelhnx"><!></button></div> <!> <!></div></div>'),at=p('<details class="directory-node svelte-pelhnx"><summary class="directory-summary list-item svelte-pelhnx"><span class="directory-icon svelte-pelhnx"><i class="fa-solid fa-right-long"></i></span> <span class="directory-name svelte-pelhnx"> </span></summary> <div class="directory-content svelte-pelhnx"></div></details>');function Le(G,e){ge(e,!0);const[F,V]=me(),v=()=>pe(he,"$LL",F);let i=ae(e,"name",3,""),k=ae(e,"node",19,()=>({})),J=ae(e,"currentPath",3,""),C=ae(e,"isOpen",3,!1),h=R(null),y=R(null),u=R(!1),b=R(!1);re(()=>{L(b,k()&&k()._isAction===!0,!0)});let d=R(_e({args:[],description:""}));re(()=>{L(d,a(b)?k().details:{args:[],description:""},!0)});let w=R("");re(()=>{L(w,J()?`${J()}/${i()}`:i(),!0)});let U=_e({});function Y(t,l){switch(l){case"int":const _=parseInt(t,10);return isNaN(_)?0:_;case"float":const A=parseFloat(t);return isNaN(A)?0:A;case"bool":return!!t;case"time":const g=new Date(t);return isNaN(g)?new Date(0):g;case"duration":return typeof t!="number"||isNaN(t)?0:t;case"text":default:return t==null?"":String(t)}}var N=Pe(),B=we(N);{var Q=t=>{var l=tt(),_=o(l),A=S(o(_),2),g=o(A,!0);n(A),n(_);var f=S(_,2);{var M=s=>{var r=Xe(),x=o(r,!0);n(r),m(()=>j(x,a(d).description)),c(s,r)};O(f,s=>{a(d).description&&s(M)})}var D=S(f,2),P=o(D),q=o(P);{var ie=s=>{var r=Ye();se(r,21,()=>a(d).args,ne,(x,I,T)=>{Qe(x,{get arg(){return a(I)},get loading(){return a(u)},get value(){return U[T]},set value($){U[T]=$}})}),n(r),c(s,r)},le=s=>{var r=Ze(),x=o(r,!0);n(r),m(I=>j(x,I),[()=>v().remote_actions.no_args()]),c(s,r)};O(q,s=>{a(d).args&&a(d).args.length>0?s(ie):s(le,!1)})}var E=S(q,2);E.__click=[We,b,u,h,y,d,U,Y,w];var H=o(E);{var oe=s=>{var r=ye("...");c(s,r)},ue=s=>{var r=ye();m(x=>j(r,x),[()=>v().remote_actions.invoke()]),c(s,r)};O(H,s=>{a(u)?s(oe):s(ue,!1)})}n(E),n(P);var z=S(P,2);{var K=s=>{var r=$e(),x=o(r),I=o(x,!0);n(x),n(r),m(()=>j(I,a(y))),c(s,r)};O(z,s=>{a(y)&&s(K)})}var ce=S(z,2);{var ve=s=>{var r=et(),x=o(r),I=o(x,!0);n(x),n(r),m(T=>j(I,T),[()=>typeof a(h)=="string"?a(h):JSON.stringify(a(h),null,2)]),c(s,r)};O(ce,s=>{a(h)!==null&&s(ve)})}n(D),n(l),m(()=>{j(g,i()),E.disabled=a(u)}),c(t,l)},W=t=>{var l=at(),_=o(l),A=S(o(_),2),g=o(A,!0);n(A),n(_);var f=S(_,2);se(f,21,()=>k().childrenOrder,ne,(M,D)=>{Le(M,{get name(){return a(D)},get node(){return k().children[a(D)]},get currentPath(){return a(w)}})}),n(f),n(l),m(()=>{l.open=C(),j(g,i())}),c(t,l)};O(B,t=>{a(b)?t(Q):t(W,!1)})}c(G,N),fe(),V()}Ve(["click"]);var rt=p('<div class="status-message svelte-wo54k"> </div>'),st=p('<div class="status-message error svelte-wo54k"><strong class="svelte-wo54k"> </strong> </div>'),nt=p('<div class="status-message svelte-wo54k"> </div>'),it=p('<div class="actions-tree svelte-wo54k"></div>'),lt=p('<div class="actions-page svelte-wo54k"><h1 class="page-title svelte-wo54k"> </h1> <!></div>');function wt(G,e){ge(e,!1);const[F,V]=me(),v=()=>pe(he,"$LL",F);let i=de({}),k=de(!0),J=de(null);Se(async()=>{try{const[h,y]=await Ae.getActions();if(y)throw y;L(i,h?C(h):{})}catch(h){L(J,h.message||"Failed to load actions")}finally{L(k,!1)}});function C(h){const y={children:{},childrenOrder:[]};return h.forEach(u=>{const b=u.path.split("/");let d=y;b.forEach((w,U)=>{U===b.length-1?(d.children[w]={_isAction:!0,details:{args:u.args,description:u.description}},d.childrenOrder.includes(w)||d.childrenOrder.push(w)):(d.children[w]||(d.children[w]={children:{},childrenOrder:[]},d.childrenOrder.push(w)),d=d.children[w])})}),y}Ie(),Ee(G,{children:(h,y)=>{var u=lt(),b=o(u),d=o(b,!0);n(b);var w=S(b,2);{var U=N=>{var B=rt(),Q=o(B,!0);n(B),m(W=>j(Q,W),[()=>v().remote_actions.loading()],te),c(N,B)},Y=(N,B)=>{{var Q=t=>{var l=st(),_=o(l),A=o(_);n(_);var g=S(_);n(l),m(f=>{j(A,`${f??""}:`),j(g,` ${a(J)??""}`)},[()=>v().remote_actions.error()],te),c(t,l)},W=(t,l)=>{{var _=g=>{var f=nt(),M=o(f,!0);n(f),m(D=>j(M,D),[()=>v().remote_actions.no_actions()],te),c(g,f)},A=g=>{var f=it();se(f,5,()=>a(i).childrenOrder,ne,(M,D)=>{const P=te(()=>a(i).childrenOrder.length<=2);Le(M,{get name(){return a(D)},get node(){return a(i).children[a(D)]},currentPath:"",get isOpen(){return a(P)}})}),n(f),c(g,f)};O(t,g=>{Object.keys(a(i).children||{}).length===0?g(_):g(A,!1)},l)}};O(N,t=>{a(J)?t(Q):t(W,!1)},B)}};O(w,N=>{a(k)?N(U):N(Y,!1)})}n(u),m(N=>j(d,N),[()=>v().remote_actions.title()],te),c(h,u)},$$slots:{default:!0}}),fe(),V()}export{wt as component};
