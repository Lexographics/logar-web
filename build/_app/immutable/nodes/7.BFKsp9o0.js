import"../chunks/CWj6FrbW.js";import{p as ie,a1 as N,w as de,o as ce,f as I,ad as ve,a as pe,a3 as r,x as n,g as e,a2 as o,a5 as l,a6 as T,a4 as ee}from"../chunks/Ddypn_Vl.js";import{d as ue,r as fe,s as O}from"../chunks/BrL2UJ6-.js";import{i as Q}from"../chunks/DFXQ8BUi.js";import{c as ge,g as z,e as _e,r as R}from"../chunks/BHZMxQwG.js";import{t as F,a as b,c as me}from"../chunks/BVINg2-B.js";import{b as ae,a as te}from"../chunks/B9uo1nGO.js";import{b as be}from"../chunks/BJ4qQQnm.js";import{B as we}from"../chunks/Dq-DC7LE.js";import{M as he}from"../chunks/CgaLH9eL.js";import{a as G}from"../chunks/MmAr2Ipg.js";class xe{constructor(){this.axios=ge()}async getFeatureFlags(){try{return[(await this.axios.get(`${G()}/feature-flags`,{headers:{...z()}})).data.data,null]}catch(t){return[null,t]}}async createFeatureFlag(t){try{const a=new FormData;return a.append("name",t.name),a.append("enabled",t.enabled.toString()),a.append("condition",t.condition),[(await this.axios.post(`${G()}/feature-flags`,a,{headers:{...z()}})).data.data,null]}catch(a){return[null,a]}}async updateFeatureFlag(t){try{const a=new FormData;return a.append("id",t.id.toString()),a.append("name",t.name),a.append("enabled",t.enabled.toString()),a.append("condition",t.condition),[(await this.axios.put(`${G()}/feature-flags`,a,{headers:{...z()}})).data.data,null]}catch(a){return[null,a]}}async deleteFeatureFlag(t){try{return await this.axios.delete(`${G()}/feature-flags?id=${t}`,{headers:{...z()}}),null}catch(a){return a}}}const J=new xe;function Fe(w,t,a,i){var s;n(t,{id:0,name:"",enabled:!0,condition:""},!0),n(a,!0),(s=e(i))==null||s.openModal()}async function ye(w,t,a,i,s,_){var y,p;if(e(t))if(e(a)){const[$,h]=await J.createFeatureFlag({id:0,name:e(t).name,enabled:e(t).enabled,condition:e(t).condition});h?n(i,h.message,!0):(n(s,[...e(s),$],!0),(y=e(_))==null||y.closeModal())}else{const[$,h]=await J.updateFeatureFlag({id:e(t).id,name:e(t).name,enabled:e(t).enabled,condition:e(t).condition});h?n(i,h.message,!0):(n(s,e(s).map(H=>H.id===$.id?$:H),!0),(p=e(_))==null||p.closeModal())}}var $e=F('<div class="loading svelte-1g4wfpl">Loading feature flags...</div>'),ke=(w,t,a)=>t(e(a)),Me=(w,t,a)=>t(e(a).id),Ce=F('<div class="flag-card svelte-1g4wfpl"><div class="flag-header svelte-1g4wfpl"><h3 class="flag-name svelte-1g4wfpl"> </h3> <label class="switch svelte-1g4wfpl"><input type="checkbox" class="svelte-1g4wfpl"> <span class="slider round svelte-1g4wfpl"></span></label></div> <div class="condition-preview svelte-1g4wfpl"><label for="flag-condition" class="svelte-1g4wfpl">Condition</label> <pre class="condition-code svelte-1g4wfpl"> </pre></div> <div class="flag-actions svelte-1g4wfpl"><button class="action-button svelte-1g4wfpl">Edit</button> <button class="action-button danger svelte-1g4wfpl">Delete</button></div></div>'),Ee=F('<div class="flags-container svelte-1g4wfpl"></div>'),Ne=F('<div class="page svelte-1g4wfpl"><div class="header-actions svelte-1g4wfpl"><h2 class="title svelte-1g4wfpl">Feature Flags</h2> <div class="buttons-container svelte-1g4wfpl"><button class="action-button primary svelte-1g4wfpl">Create New Flag</button></div></div> <!></div>'),Se=F('<p class="error-message svelte-1g4wfpl"> </p>'),De=(w,t)=>{var a;return(a=e(t))==null?void 0:a.closeModal()},Ae=F('<div class="modal-form svelte-1g4wfpl"><div class="form-group svelte-1g4wfpl"><label for="flag-name" class="svelte-1g4wfpl">Name</label> <input type="text" id="flag-name" placeholder="Enter flag name" class="svelte-1g4wfpl"></div> <div class="form-group svelte-1g4wfpl"><label class="switch-label svelte-1g4wfpl"><span>Enabled</span> <label class="switch svelte-1g4wfpl"><input type="checkbox" class="svelte-1g4wfpl"> <span class="slider round svelte-1g4wfpl"></span></label></label></div> <div class="form-group svelte-1g4wfpl"><label for="flag-condition" class="svelte-1g4wfpl">Condition</label> <textarea id="flag-condition" rows="6" placeholder="Enter condition expression" class="svelte-1g4wfpl"></textarea></div> <!> <div class="modal-actions svelte-1g4wfpl"><button class="action-button svelte-1g4wfpl">Cancel</button> <button class="action-button success svelte-1g4wfpl">Save</button></div></div>'),Be=F("<!> <!>",1);function Oe(w,t){ie(t,!0);let a=N(de([])),i=N(null),s=N(null),_=N(!1),y=N(!1),p=N(null);ce(async()=>{await $()});async function $(){n(y,!0),n(p,null);const[d,u]=await J.getFeatureFlags();u?n(p,u.message,!0):n(a,d,!0),n(y,!1)}function h(d){var u;n(s,{...d},!0),n(_,!1),(u=e(i))==null||u.openModal()}function H(){n(p,null),n(s,null),n(_,!1)}async function se(d){const u=e(a).find(v=>v.id===d);if(u&&confirm(`Are you sure you want to delete the flag "${u.name}"?`)){const v=await J.deleteFeatureFlag(d);v?n(p,v.message,!0):n(a,e(a).filter(x=>x.id!==d),!0)}}var W=Be(),X=I(W);we(X,{children:(d,u)=>{var v=Ne(),x=r(v),U=o(r(x),2),S=r(U);S.__click=[Fe,s,_,i],l(U),l(x);var D=o(x,2);{var A=f=>{var m=$e();b(f,m)},V=f=>{var m=Ee();_e(m,21,()=>e(a),k=>k.id,(k,g,j)=>{var M=Ce(),C=r(M),B=r(C),q=r(B,!0);l(B);var L=o(B,2),P=r(L);R(P),P.disabled=!0,T(2),l(L),l(C);var c=o(C,2),E=o(r(c),2),K=r(E,!0);l(E),l(c);var Y=o(c,2),Z=r(Y);Z.__click=[ke,h,g];var re=o(Z,2);re.__click=[Me,se,g],l(Y),l(M),ee(()=>{O(q,e(g).name),O(K,e(g).condition||"No condition set")}),te(P,()=>e(g).enabled,oe=>e(g).enabled=oe),b(k,M)}),l(m),b(f,m)};Q(D,f=>{e(y)?f(A):f(V,!1)})}l(v),b(d,v)},$$slots:{default:!0}});var le=o(X,2);const ne=ve(()=>e(_)?"Create New Flag":"Edit Flag");be(he(le,{get title(){return e(ne)},onClose:H,children:(d,u)=>{var v=me(),x=I(v);{var U=S=>{var D=Ae(),A=r(D),V=o(r(A),2);R(V),l(A);var f=o(A,2),m=r(f),k=o(r(m),2),g=r(k);R(g),T(2),l(k),l(m),l(f);var j=o(f,2),M=o(r(j),2);fe(M),l(j);var C=o(j,2);{var B=c=>{var E=Se(),K=r(E,!0);l(E),ee(()=>O(K,e(p))),b(c,E)};Q(C,c=>{e(p)&&c(B)})}var q=o(C,2),L=r(q);L.__click=[De,i];var P=o(L,2);P.__click=[ye,s,_,p,a,i],l(q),l(D),ae(V,()=>e(s).name,c=>e(s).name=c),te(g,()=>e(s).enabled,c=>e(s).enabled=c),ae(M,()=>e(s).condition,c=>e(s).condition=c),b(S,D)};Q(x,S=>{e(s)&&S(U)})}b(d,v)},$$slots:{default:!0}}),d=>n(i,d,!0),()=>e(i)),b(w,W),pe()}ue(["click"]);export{Oe as component};
