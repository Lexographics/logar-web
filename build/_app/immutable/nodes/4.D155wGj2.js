import"../chunks/CWj6FrbW.js";import"../chunks/Bm1NOW0e.js";import{p as ge,w as _e,a1 as z,ad as Oe,u as re,g as t,a3 as l,a2 as S,a5 as i,a4 as p,a as me,f as qe,a6 as Ne,x as L,o as Se,y as de,t as te}from"../chunks/C_K9WeA7.js";import{s as O,d as Ve}from"../chunks/DUF1MtVn.js";import{i as A}from"../chunks/D5T9OJL1.js";import{c as De,g as be,r as X,e as se,i as ie}from"../chunks/Dlu4oWiR.js";import{t as f,a as c,c as Pe,d as xe}from"../chunks/COyw5ioR.js";import{i as Ie}from"../chunks/BzkOwhOr.js";import{a as fe,s as pe}from"../chunks/CIIlVVW4.js";import{B as je}from"../chunks/M4sgoBUN.js";import{a as ke}from"../chunks/Xh6yIWb-.js";import{p as ae}from"../chunks/D3qUkpV1.js";import{L as he}from"../chunks/Nv5XlIL8.js";import{b as $,a as Ee}from"../chunks/B-UvMiJO.js";import{b as Fe}from"../chunks/K7tbmCf0.js";class Je{constructor(){this.axios=De()}async getActions(){try{return[(await this.axios.get(`${ke()}/actions`,{headers:{...be()}})).data.data,null]}catch(e){return[null,e]}}async invokeAction(e,E){try{const V=E.map(n=>{if(typeof n=="boolean")return n?"true":"false";if(typeof n=="object"&&n!==null)try{return JSON.stringify(n)}catch(k){return console.warn("Could not JSON stringify argument:",n,k),String(n)}return String(n)});return[(await this.axios.post(`${ke()}/actions/invoke`,{path:e,args:V},{headers:{...be()}})).data.data,null]}catch(V){return[null,V]}}}const we=new Je;var Te=f('<span class="arg-type svelte-1yo4hhg"> </span> <br>',1),Ue=f('<input type="text" class="input input-sm arg-input svelte-1yo4hhg">'),Be=f('<input type="number" class="input input-sm arg-input svelte-1yo4hhg" step="1">'),Me=f('<input type="number" class="input input-sm arg-input svelte-1yo4hhg" step="any">'),Ce=f('<input type="checkbox" class="checkbox arg-input svelte-1yo4hhg">'),He=f('<input type="datetime-local" class="input input-sm arg-input svelte-1yo4hhg">'),Ke=f("<option> </option>"),Re=f('<div class="duration-input-group svelte-1yo4hhg"><input type="number" class="input input-sm arg-input duration-number svelte-1yo4hhg" step="any"> <select class="select select-sm arg-input duration-unit svelte-1yo4hhg"></select></div>'),ze=f('<input type="text" class="input input-sm arg-input svelte-1yo4hhg" placeholder="Unknown kind">'),Ge=f('<label class="arg-label svelte-1yo4hhg"><div><!> <span class="arg-type svelte-1yo4hhg"> </span></div> <!></label>');function Qe(G,e){ge(e,!0);const[E,V]=pe(),u=()=>fe(he,"$LL",E);let n=ae(e,"value",15);const k=_e({nsec:{value:1,label:u().remote_actions.units.nsec()},µsec:{value:1e3,label:u().remote_actions.units.usec()},msec:{value:1e6,label:u().remote_actions.units.msec()},sec:{value:1e9,label:u().remote_actions.units.sec()},min:{value:60*1e9,label:u().remote_actions.units.min()},hour:{value:3600*1e9,label:u().remote_actions.units.hour()},day:{value:86400*1e9,label:u().remote_actions.units.day()},week:{value:7*86400*1e9,label:u().remote_actions.units.week()},month:{value:30*86400*1e9,label:u().remote_actions.units.month()},year:{value:365*86400*1e9,label:u().remote_actions.units.year()}}),F=Object.keys(k);function H(a,o){const _=k[o].value;return typeof a!="number"||isNaN(a)||!_?0:Math.round(a*_)}let h=z(0),x=z("sec"),v=Oe(()=>e.arg.kind==="duration");re(()=>{if(t(v)){const a=H(t(h),t(x));a!==n()&&n(a)}});var y=Ge(),d=l(y),q=l(d);{var T=a=>{var o=Te(),_=qe(o),w=l(_,!0);i(_),Ne(2),p(()=>O(w,e.arg.name)),c(a,o)};A(q,a=>{e.arg.name&&a(T)})}var Y=S(q,2),N=l(Y,!0);i(Y),i(d);var U=S(d,2);{var Q=a=>{var o=Ue();X(o),p(()=>o.disabled=e.loading),$(o,n),c(a,o)},W=(a,o)=>{{var _=g=>{var m=Be();X(m),p(()=>m.disabled=e.loading),$(m,n),c(g,m)},w=(g,m)=>{{var B=P=>{var M=Me();X(M),p(()=>M.disabled=e.loading),$(M,n),c(P,M)},D=(P,M)=>{{var ne=j=>{var K=Ce();X(K),p(()=>K.disabled=e.loading),Ee(K,n),c(j,K)},oe=(j,K)=>{{var le=C=>{var R=He();X(R),p(()=>R.disabled=e.loading),$(R,n),c(C,R)},ve=(C,R)=>{{var ce=s=>{var r=Re(),b=l(r);X(b);var I=S(b,2);se(I,21,()=>F,ie,(J,Z)=>{var ee=Ke(),ye={},Ae=l(ee,!0);i(ee),p(()=>{ye!==(ye=t(Z))&&(ee.value=(ee.__value=t(Z))==null?"":t(Z)),O(Ae,k[t(Z)].label)}),c(J,ee)}),i(I),i(r),p(()=>{b.disabled=e.loading,I.disabled=e.loading}),$(b,()=>t(h),J=>L(h,J)),Fe(I,()=>t(x),J=>L(x,J)),c(s,r)},ue=s=>{var r=ze();X(r),p(()=>r.disabled=e.loading),$(r,n),c(s,r)};A(C,s=>{e.arg.kind==="duration"?s(ce):s(ue,!1)},R)}};A(j,C=>{e.arg.kind==="time"?C(le):C(ve,!1)},K)}};A(P,j=>{e.arg.kind==="bool"?j(ne):j(oe,!1)},M)}};A(g,P=>{e.arg.kind==="float"||e.arg.kind==="float32"||e.arg.kind==="float64"?P(B):P(D,!1)},m)}};A(a,g=>{e.arg.kind==="int"||e.arg.kind==="int8"||e.arg.kind==="int16"||e.arg.kind==="int32"||e.arg.kind==="int64"||e.arg.kind==="uint"||e.arg.kind==="uint8"||e.arg.kind==="uint16"||e.arg.kind==="uint32"||e.arg.kind==="uint64"?g(_):g(w,!1)},o)}};A(U,a=>{e.arg.kind==="text"?a(Q):a(W,!1)})}i(y),p(()=>O(N,e.arg.type)),c(G,y),me(),V()}async function We(G,e,E,V,u,n,k,F,H){var x;if(!t(e))return;L(E,!0),L(V,null),L(u,null);const h=t(n).args.map((v,y)=>{const d=k[y];return F(d,v.kind)});try{const[v,y]=await we.invokeAction(t(H),h);if(y)throw y;v&&v.error?L(u,v.error,!0):v?L(V,v.result,!0):L(u,"Received unexpected null response")}catch(v){L(u,((x=v.response)==null?void 0:x.data)||v.message||`Failed to invoke action '${t(H)}'`,!0)}finally{L(E,!1)}}var Xe=f('<p class="action-description svelte-q1i55v"> </p>'),Ye=f('<div class="args-container svelte-q1i55v"></div>'),Ze=f('<p class="no-args-message svelte-q1i55v"> </p>'),$e=f('<div class="output-box error-display svelte-q1i55v"><pre class="svelte-q1i55v"> </pre></div>'),et=f('<div class="output-box result-box svelte-q1i55v"><pre class="svelte-q1i55v"> </pre></div>'),tt=f('<div class="action-node svelte-q1i55v"><div class="action-header svelte-q1i55v"><div class="action-icon svelte-q1i55v">♦</div> <span class="action-name svelte-q1i55v"> </span></div> <!> <div class="action-body svelte-q1i55v"><div class="input-row svelte-q1i55v"><!> <button class="btn btn-sm invoke-button variant-ghost-primary svelte-q1i55v"><!></button></div> <!> <!></div></div>'),at=f('<details class="directory-node svelte-q1i55v"><summary class="directory-summary list-item svelte-q1i55v"><span class="directory-icon svelte-q1i55v"></span> <span class="directory-name svelte-q1i55v"> </span></summary> <div class="directory-content svelte-q1i55v"></div></details>');function Le(G,e){ge(e,!0);const[E,V]=pe(),u=()=>fe(he,"$LL",E);let n=ae(e,"name",3,""),k=ae(e,"node",19,()=>({})),F=ae(e,"currentPath",3,""),H=ae(e,"isOpen",3,!1),h=z(null),x=z(null),v=z(!1),y=z(!1);re(()=>{L(y,k()&&k()._isAction===!0,!0)});let d=z(_e({args:[],description:""}));re(()=>{L(d,t(y)?k().details:{args:[],description:""},!0)});let q=z("");re(()=>{L(q,F()?`${F()}/${n()}`:n(),!0)});let T=_e({});function Y(a,o){switch(o){case"int":const _=parseInt(a,10);return isNaN(_)?0:_;case"float":const w=parseFloat(a);return isNaN(w)?0:w;case"bool":return!!a;case"time":const g=new Date(a);return isNaN(g)?new Date(0):g;case"duration":return typeof a!="number"||isNaN(a)?0:a;case"text":default:return a==null?"":String(a)}}var N=Pe(),U=qe(N);{var Q=a=>{var o=tt(),_=l(o),w=S(l(_),2),g=l(w,!0);i(w),i(_);var m=S(_,2);{var B=s=>{var r=Xe(),b=l(r,!0);i(r),p(()=>O(b,t(d).description)),c(s,r)};A(m,s=>{t(d).description&&s(B)})}var D=S(m,2),P=l(D),M=l(P);{var ne=s=>{var r=Ye();se(r,21,()=>t(d).args,ie,(b,I,J)=>{Qe(b,{get arg(){return t(I)},get loading(){return t(v)},get value(){return T[J]},set value(Z){T[J]=Z}})}),i(r),c(s,r)},oe=s=>{var r=Ze(),b=l(r,!0);i(r),p(I=>O(b,I),[()=>u().remote_actions.no_args()]),c(s,r)};A(M,s=>{t(d).args&&t(d).args.length>0?s(ne):s(oe,!1)})}var j=S(M,2);j.__click=[We,y,v,h,x,d,T,Y,q];var K=l(j);{var le=s=>{var r=xe("...");c(s,r)},ve=s=>{var r=xe();p(b=>O(r,b),[()=>u().remote_actions.invoke()]),c(s,r)};A(K,s=>{t(v)?s(le):s(ve,!1)})}i(j),i(P);var C=S(P,2);{var R=s=>{var r=$e(),b=l(r),I=l(b,!0);i(b),i(r),p(()=>O(I,t(x))),c(s,r)};A(C,s=>{t(x)&&s(R)})}var ce=S(C,2);{var ue=s=>{var r=et(),b=l(r),I=l(b,!0);i(b),i(r),p(J=>O(I,J),[()=>typeof t(h)=="string"?t(h):JSON.stringify(t(h),null,2)]),c(s,r)};A(ce,s=>{t(h)!==null&&s(ue)})}i(D),i(o),p(()=>{O(g,n()),j.disabled=t(v)}),c(a,o)},W=a=>{var o=at(),_=l(o),w=S(l(_),2),g=l(w,!0);i(w),i(_);var m=S(_,2);se(m,21,()=>k().childrenOrder,ie,(B,D)=>{Le(B,{get name(){return t(D)},get node(){return k().children[t(D)]},get currentPath(){return t(q)}})}),i(m),i(o),p(()=>{o.open=H(),O(g,n())}),c(a,o)};A(U,a=>{t(y)?a(Q):a(W,!1)})}c(G,N),me(),V()}Ve(["click"]);var rt=f('<div class="status-message svelte-xqa865"> </div>'),st=f('<div class="status-message error svelte-xqa865"><strong class="svelte-xqa865"> </strong> </div>'),it=f('<div class="status-message svelte-xqa865"> </div>'),nt=f('<div class="actions-tree svelte-xqa865"></div>'),ot=f('<div class="actions-page svelte-xqa865"><h1 class="page-title svelte-xqa865"> </h1> <!></div>');function qt(G,e){ge(e,!1);const[E,V]=pe(),u=()=>fe(he,"$LL",E);let n=de({}),k=de(!0),F=de(null);Se(async()=>{try{const[h,x]=await we.getActions();if(x)throw x;L(n,h?H(h):{})}catch(h){L(F,h.message||"Failed to load actions")}finally{L(k,!1)}});function H(h){const x={children:{},childrenOrder:[]};return h.forEach(v=>{const y=v.path.split("/");let d=x;y.forEach((q,T)=>{T===y.length-1?(d.children[q]={_isAction:!0,details:{args:v.args,description:v.description}},d.childrenOrder.includes(q)||d.childrenOrder.push(q)):(d.children[q]||(d.children[q]={children:{},childrenOrder:[]},d.childrenOrder.push(q)),d=d.children[q])})}),x}Ie(),je(G,{children:(h,x)=>{var v=ot(),y=l(v),d=l(y,!0);i(y);var q=S(y,2);{var T=N=>{var U=rt(),Q=l(U,!0);i(U),p(W=>O(Q,W),[()=>u().remote_actions.loading()],te),c(N,U)},Y=(N,U)=>{{var Q=a=>{var o=st(),_=l(o),w=l(_);i(_);var g=S(_);i(o),p(m=>{O(w,`${m??""}:`),O(g,` ${t(F)??""}`)},[()=>u().remote_actions.error()],te),c(a,o)},W=(a,o)=>{{var _=g=>{var m=it(),B=l(m,!0);i(m),p(D=>O(B,D),[()=>u().remote_actions.no_actions()],te),c(g,m)},w=g=>{var m=nt();se(m,5,()=>t(n).childrenOrder,ie,(B,D)=>{const P=te(()=>t(n).childrenOrder.length<=2);Le(B,{get name(){return t(D)},get node(){return t(n).children[t(D)]},currentPath:"",get isOpen(){return t(P)}})}),i(m),c(g,m)};A(a,g=>{Object.keys(t(n).children||{}).length===0?g(_):g(w,!1)},o)}};A(N,a=>{t(F)?a(Q):a(W,!1)},U)}};A(q,N=>{t(k)?N(T):N(Y,!1)})}i(v),p(N=>O(d,N),[()=>u().remote_actions.title()],te),c(h,v)},$$slots:{default:!0}}),me(),V()}export{qt as component};
