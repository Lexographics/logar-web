import"../chunks/CWj6FrbW.js";import{p as ie,a1 as N,w as de,o as ce,f as I,ad as ve,a as ue,a3 as r,x as n,g as e,a2 as o,a5 as l,a6 as T,a4 as ee}from"../chunks/C_K9WeA7.js";import{d as fe,r as pe,s as O}from"../chunks/DUF1MtVn.js";import{i as Q}from"../chunks/D5T9OJL1.js";import{c as _e,g as z,e as me,r as R}from"../chunks/Dlu4oWiR.js";import{t as x,a as g,c as be}from"../chunks/COyw5ioR.js";import{b as ae,a as te}from"../chunks/B-UvMiJO.js";import{b as ge}from"../chunks/BqzVn-q-.js";import{B as ke}from"../chunks/M4sgoBUN.js";import{M as he}from"../chunks/DDzfTnAx.js";import{a as G}from"../chunks/Xh6yIWb-.js";class we{constructor(){this.axios=_e()}async getFeatureFlags(){try{return[(await this.axios.get(`${G()}/feature-flags`,{headers:{...z()}})).data.data,null]}catch(t){return[null,t]}}async createFeatureFlag(t){try{const a=new FormData;return a.append("name",t.name),a.append("enabled",t.enabled.toString()),a.append("condition",t.condition),[(await this.axios.post(`${G()}/feature-flags`,a,{headers:{...z()}})).data.data,null]}catch(a){return[null,a]}}async updateFeatureFlag(t){try{const a=new FormData;return a.append("id",t.id.toString()),a.append("name",t.name),a.append("enabled",t.enabled.toString()),a.append("condition",t.condition),[(await this.axios.put(`${G()}/feature-flags`,a,{headers:{...z()}})).data.data,null]}catch(a){return[null,a]}}async deleteFeatureFlag(t){try{return await this.axios.delete(`${G()}/feature-flags?id=${t}`,{headers:{...z()}}),null}catch(a){return a}}}const J=new we;function xe(k,t,a,i){var s;n(t,{id:0,name:"",enabled:!0,condition:""},!0),n(a,!0),(s=e(i))==null||s.openModal()}async function Fe(k,t,a,i,s,m){var F,u;if(e(t))if(e(a)){const[y,h]=await J.createFeatureFlag({id:0,name:e(t).name,enabled:e(t).enabled,condition:e(t).condition});h?n(i,h.message,!0):(n(s,[...e(s),y],!0),(F=e(m))==null||F.closeModal())}else{const[y,h]=await J.updateFeatureFlag({id:e(t).id,name:e(t).name,enabled:e(t).enabled,condition:e(t).condition});h?n(i,h.message,!0):(n(s,e(s).map(H=>H.id===y.id?y:H),!0),(u=e(m))==null||u.closeModal())}}var ye=x('<div class="loading svelte-cf08dk">Loading feature flags...</div>'),$e=(k,t,a)=>t(e(a)),Me=(k,t,a)=>t(e(a).id),Ce=x('<div class="flag-card svelte-cf08dk"><div class="flag-header svelte-cf08dk"><h3 class="flag-name svelte-cf08dk"> </h3> <label class="switch svelte-cf08dk"><input type="checkbox" class="svelte-cf08dk"> <span class="slider round svelte-cf08dk"></span></label></div> <div class="condition-preview svelte-cf08dk"><label for="flag-condition" class="svelte-cf08dk">Condition</label> <pre class="condition-code svelte-cf08dk"> </pre></div> <div class="flag-actions svelte-cf08dk"><button class="action-button svelte-cf08dk">Edit</button> <button class="action-button danger svelte-cf08dk">Delete</button></div></div>'),Ee=x('<div class="flags-container svelte-cf08dk"></div>'),Ne=x('<div class="page svelte-cf08dk"><div class="header-actions svelte-cf08dk"><h2 class="title svelte-cf08dk">Feature Flags</h2> <div class="buttons-container svelte-cf08dk"><button class="action-button primary svelte-cf08dk">Create New Flag</button></div></div> <!></div>'),Se=x('<p class="error-message svelte-cf08dk"> </p>'),De=(k,t)=>{var a;return(a=e(t))==null?void 0:a.closeModal()},Ae=x('<div class="modal-form svelte-cf08dk"><div class="form-group svelte-cf08dk"><label for="flag-name" class="svelte-cf08dk">Name</label> <input type="text" id="flag-name" placeholder="Enter flag name" class="svelte-cf08dk"></div> <div class="form-group svelte-cf08dk"><label class="switch-label svelte-cf08dk"><span>Enabled</span> <label class="switch svelte-cf08dk"><input type="checkbox" class="svelte-cf08dk"> <span class="slider round svelte-cf08dk"></span></label></label></div> <div class="form-group svelte-cf08dk"><label for="flag-condition" class="svelte-cf08dk">Condition</label> <textarea id="flag-condition" rows="6" placeholder="Enter condition expression" class="svelte-cf08dk"></textarea></div> <!> <div class="modal-actions svelte-cf08dk"><button class="action-button svelte-cf08dk">Cancel</button> <button class="action-button success svelte-cf08dk">Save</button></div></div>'),Be=x("<!> <!>",1);function Oe(k,t){ie(t,!0);let a=N(de([])),i=N(null),s=N(null),m=N(!1),F=N(!1),u=N(null);ce(async()=>{await y()});async function y(){n(F,!0),n(u,null);const[d,f]=await J.getFeatureFlags();f?n(u,f.message,!0):n(a,d,!0),n(F,!1)}function h(d){var f;n(s,{...d},!0),n(m,!1),(f=e(i))==null||f.openModal()}function H(){n(u,null),n(s,null),n(m,!1)}async function se(d){const f=e(a).find(v=>v.id===d);if(f&&confirm(`Are you sure you want to delete the flag "${f.name}"?`)){const v=await J.deleteFeatureFlag(d);v?n(u,v.message,!0):n(a,e(a).filter(w=>w.id!==d),!0)}}var W=Be(),X=I(W);ke(X,{children:(d,f)=>{var v=Ne(),w=r(v),U=o(r(w),2),S=r(U);S.__click=[xe,s,m,i],l(U),l(w);var D=o(w,2);{var A=p=>{var b=ye();g(p,b)},V=p=>{var b=Ee();me(b,21,()=>e(a),$=>$.id,($,_,j)=>{var M=Ce(),C=r(M),B=r(C),q=r(B,!0);l(B);var L=o(B,2),P=r(L);R(P),P.disabled=!0,T(2),l(L),l(C);var c=o(C,2),E=o(r(c),2),K=r(E,!0);l(E),l(c);var Y=o(c,2),Z=r(Y);Z.__click=[$e,h,_];var re=o(Z,2);re.__click=[Me,se,_],l(Y),l(M),ee(()=>{O(q,e(_).name),O(K,e(_).condition||"No condition set")}),te(P,()=>e(_).enabled,oe=>e(_).enabled=oe),g($,M)}),l(b),g(p,b)};Q(D,p=>{e(F)?p(A):p(V,!1)})}l(v),g(d,v)},$$slots:{default:!0}});var le=o(X,2);const ne=ve(()=>e(m)?"Create New Flag":"Edit Flag");ge(he(le,{get title(){return e(ne)},onClose:H,children:(d,f)=>{var v=be(),w=I(v);{var U=S=>{var D=Ae(),A=r(D),V=o(r(A),2);R(V),l(A);var p=o(A,2),b=r(p),$=o(r(b),2),_=r($);R(_),T(2),l($),l(b),l(p);var j=o(p,2),M=o(r(j),2);pe(M),l(j);var C=o(j,2);{var B=c=>{var E=Se(),K=r(E,!0);l(E),ee(()=>O(K,e(u))),g(c,E)};Q(C,c=>{e(u)&&c(B)})}var q=o(C,2),L=r(q);L.__click=[De,i];var P=o(L,2);P.__click=[Fe,s,m,u,a,i],l(q),l(D),ae(V,()=>e(s).name,c=>e(s).name=c),te(_,()=>e(s).enabled,c=>e(s).enabled=c),ae(M,()=>e(s).condition,c=>e(s).condition=c),g(S,D)};Q(w,S=>{e(s)&&S(U)})}g(d,v)},$$slots:{default:!0}}),d=>n(i,d,!0),()=>e(i)),g(k,W),ue()}fe(["click"]);export{Oe as component};
