import"../chunks/CWj6FrbW.js";import{p as ie,a4 as C,y as Y,o as de,f as ce,a as ve,a6 as l,z as n,g as e,a5 as o,a8 as s,a9 as Z,ag as pe,a7 as I}from"../chunks/vtVjXRxL.js";import{d as ue,r as fe,s as J}from"../chunks/DtjsYg9O.js";import{i as T}from"../chunks/CXzoa0Vj.js";import{c as ge,g as H,e as _e,r as K}from"../chunks/CgYbRSvx.js";import{f as F,a as x}from"../chunks/BKrJ63KQ.js";import{b as ee,a as ae}from"../chunks/B1SoyIIh.js";import{b as me}from"../chunks/WdmN_MJW.js";import{B as be}from"../chunks/COKUAaBi.js";import{M as we}from"../chunks/uaDaiAmK.js";import{a as U}from"../chunks/BP3o4HH5.js";class he{constructor(){this.axios=ge()}async getFeatureFlags(){try{return[(await this.axios.get(`${U()}/feature-flags`,{headers:{...H()}})).data.data,null]}catch(t){return[null,t]}}async createFeatureFlag(t){try{const a=new FormData;return a.append("name",t.name),a.append("enabled",t.enabled.toString()),a.append("condition",t.condition),[(await this.axios.post(`${U()}/feature-flags`,a,{headers:{...H()}})).data.data,null]}catch(a){return[null,a]}}async updateFeatureFlag(t){try{const a=new FormData;return a.append("id",t.id.toString()),a.append("name",t.name),a.append("enabled",t.enabled.toString()),a.append("condition",t.condition),[(await this.axios.put(`${U()}/feature-flags`,a,{headers:{...H()}})).data.data,null]}catch(a){return[null,a]}}async deleteFeatureFlag(t){try{return await this.axios.delete(`${U()}/feature-flags?id=${t}`,{headers:{...H()}}),null}catch(a){return a}}}const V=new he;function xe(w,t,a,i){var r;n(t,{id:0,name:"",enabled:!0,condition:""},!0),n(a,!0),(r=e(i))==null||r.openModal()}async function Fe(w,t,a,i,r,_){var y,p;if(e(t))if(e(a)){const[$,h]=await V.createFeatureFlag({id:0,name:e(t).name,enabled:e(t).enabled,condition:e(t).condition});h?n(i,h.message,!0):(n(r,[...e(r),$],!0),(y=e(_))==null||y.closeModal())}else{const[$,h]=await V.updateFeatureFlag({id:e(t).id,name:e(t).name,enabled:e(t).enabled,condition:e(t).condition});h?n(i,h.message,!0):(n(r,e(r).map(A=>A.id===$.id?$:A),!0),(p=e(_))==null||p.closeModal())}}var ye=F('<div class="loading svelte-1g4wfpl">Loading feature flags...</div>'),$e=(w,t,a)=>t(e(a)),ke=(w,t,a)=>t(e(a).id),Me=F('<div class="flag-card svelte-1g4wfpl"><div class="flag-header svelte-1g4wfpl"><h3 class="flag-name svelte-1g4wfpl"> </h3> <label class="switch svelte-1g4wfpl"><input type="checkbox" class="svelte-1g4wfpl"/> <span class="slider round svelte-1g4wfpl"></span></label></div> <div class="condition-preview svelte-1g4wfpl"><label for="flag-condition" class="svelte-1g4wfpl">Condition</label> <pre class="condition-code svelte-1g4wfpl"> </pre></div> <div class="flag-actions svelte-1g4wfpl"><button class="action-button svelte-1g4wfpl">Edit</button> <button class="action-button danger svelte-1g4wfpl">Delete</button></div></div>'),Ce=F('<div class="flags-container svelte-1g4wfpl"></div>'),Ee=F('<div class="page svelte-1g4wfpl"><div class="header-actions svelte-1g4wfpl"><h2 class="title svelte-1g4wfpl">Feature Flags</h2> <div class="buttons-container svelte-1g4wfpl"><button class="action-button primary svelte-1g4wfpl">Create New Flag</button></div></div> <!></div>'),Ne=F('<p class="error-message svelte-1g4wfpl"> </p>'),Se=(w,t)=>{var a;return(a=e(t))==null?void 0:a.closeModal()},De=F('<div class="modal-form svelte-1g4wfpl"><div class="form-group svelte-1g4wfpl"><label for="flag-name" class="svelte-1g4wfpl">Name</label> <input type="text" id="flag-name" placeholder="Enter flag name" class="svelte-1g4wfpl"/></div> <div class="form-group svelte-1g4wfpl"><label class="switch-label svelte-1g4wfpl"><span>Enabled</span> <label class="switch svelte-1g4wfpl"><input type="checkbox" class="svelte-1g4wfpl"/> <span class="slider round svelte-1g4wfpl"></span></label></label></div> <div class="form-group svelte-1g4wfpl"><label for="flag-condition" class="svelte-1g4wfpl">Condition</label> <textarea id="flag-condition" rows="6" placeholder="Enter condition expression" class="svelte-1g4wfpl"></textarea></div> <!> <div class="modal-actions svelte-1g4wfpl"><button class="action-button svelte-1g4wfpl">Cancel</button> <button class="action-button success svelte-1g4wfpl">Save</button></div></div>'),Ae=F("<!> <!>",1);function Ke(w,t){ie(t,!0);let a=C(Y([])),i=C(null),r=C(Y({id:0,name:"",enabled:!0,condition:""})),_=C(!1),y=C(!1),p=C(null);de(async()=>{await $()});async function $(){n(y,!0),n(p,null);const[d,u]=await V.getFeatureFlags();u?n(p,u.message,!0):n(a,d,!0),n(y,!1)}function h(d){var u;n(r,{...d},!0),n(_,!1),(u=e(i))==null||u.openModal()}function A(){n(p,null),n(_,!1)}async function te(d){const u=e(a).find(v=>v.id===d);if(u&&confirm(`Are you sure you want to delete the flag "${u.name}"?`)){const v=await V.deleteFeatureFlag(d);v?n(p,v.message,!0):n(a,e(a).filter(g=>g.id!==d),!0)}}var O=Ae(),Q=ce(O);be(Q,{children:(d,u)=>{var v=Ee(),g=l(v),E=o(l(g),2),N=l(E);N.__click=[xe,r,_,i],s(E),s(g);var B=o(g,2);{var L=f=>{var m=ye();x(f,m)},P=f=>{var m=Ce();_e(m,21,()=>e(a),k=>k.id,(k,b,j)=>{var M=Me(),S=l(M),c=l(S),D=l(c,!0);s(c);var z=o(c,2),q=l(z);K(q),q.disabled=!0,Z(2),s(z),s(S);var G=o(S,2),R=o(l(G),2),ne=l(R,!0);s(R),s(G);var W=o(G,2),X=l(W);X.__click=[$e,h,b];var re=o(X,2);re.__click=[ke,te,b],s(W),s(M),I(()=>{J(D,e(b).name),J(ne,e(b).condition||"No condition set")}),ae(q,()=>e(b).enabled,oe=>e(b).enabled=oe),x(k,M)}),s(m),x(f,m)};T(B,f=>{e(y)?f(L):f(P,!1)})}s(v),x(d,v)},$$slots:{default:!0}});var se=o(Q,2);const le=pe(()=>e(_)?"Create New Flag":"Edit Flag");me(we(se,{get title(){return e(le)},onClose:A,children:(d,u)=>{var v=De(),g=l(v),E=o(l(g),2);K(E),s(g);var N=o(g,2),B=l(N),L=o(l(B),2),P=l(L);K(P),Z(2),s(L),s(B),s(N);var f=o(N,2),m=o(l(f),2);fe(m),s(f);var k=o(f,2);{var b=c=>{var D=Ne(),z=l(D,!0);s(D),I(()=>J(z,e(p))),x(c,D)};T(k,c=>{e(p)&&c(b)})}var j=o(k,2),M=l(j);M.__click=[Se,i];var S=o(M,2);S.__click=[Fe,r,_,p,a,i],s(j),s(v),ee(E,()=>e(r).name,c=>e(r).name=c),ae(P,()=>e(r).enabled,c=>e(r).enabled=c),ee(m,()=>e(r).condition,c=>e(r).condition=c),x(d,v)},$$slots:{default:!0}}),d=>n(i,d,!0),()=>e(i)),x(w,O),ve()}ue(["click"]);export{Ke as component};
