import"../chunks/CWj6FrbW.js";import"../chunks/l4FF0VG9.js";import{p as fe,w as _e,a1 as z,ad as je,u as re,g as t,a3 as o,a2 as S,a5 as n,a4 as p,a as ge,f as we,a6 as Ne,x as A,o as Se,y as de,t as te}from"../chunks/Ddypn_Vl.js";import{s as j,d as Ve}from"../chunks/BrL2UJ6-.js";import{i as O}from"../chunks/DFXQ8BUi.js";import{c as De,g as he,r as X,e as se,i as ne}from"../chunks/BHZMxQwG.js";import{t as m,a as c,c as Pe,d as ke}from"../chunks/BVINg2-B.js";import{i as Ie}from"../chunks/BUd0Bzu3.js";import{a as me,s as pe}from"../chunks/Ce7vjTte.js";import{B as Ee}from"../chunks/Dq-DC7LE.js";import{a as xe}from"../chunks/MmAr2Ipg.js";import{p as ae}from"../chunks/CRh1fc7F.js";import{L as be}from"../chunks/BjWez0Tu.js";import{b as $,a as Fe}from"../chunks/B9uo1nGO.js";import{b as Je}from"../chunks/Bhxcunxs.js";class Te{constructor(){this.axios=De()}async getActions(){try{return[(await this.axios.get(`${xe()}/actions`,{headers:{...he()}})).data.data,null]}catch(e){return[null,e]}}async invokeAction(e,F){try{const V=F.map(i=>{if(typeof i=="boolean")return i?"true":"false";if(typeof i=="object"&&i!==null)try{return JSON.stringify(i)}catch(x){return console.warn("Could not JSON stringify argument:",i,x),String(i)}return String(i)});return[(await this.axios.post(`${xe()}/actions/invoke`,{path:e,args:V},{headers:{...he()}})).data.data,null]}catch(V){return[null,V]}}}const Le=new Te;var Ue=m('<span class="arg-type svelte-1jugud0"> </span> <br>',1),Be=m('<input type="text" class="input input-sm arg-input svelte-1jugud0">'),Me=m('<input type="number" class="input input-sm arg-input svelte-1jugud0" step="1">'),qe=m('<input type="number" class="input input-sm arg-input svelte-1jugud0" step="any">'),Ce=m('<input type="checkbox" class="checkbox arg-input svelte-1jugud0">'),He=m('<input type="datetime-local" class="input input-sm arg-input svelte-1jugud0">'),Ke=m("<option> </option>"),Re=m('<div class="duration-input-group svelte-1jugud0"><input type="number" class="input input-sm arg-input duration-number svelte-1jugud0" step="any"> <select class="select select-sm arg-input duration-unit svelte-1jugud0"></select></div>'),ze=m('<input type="text" class="input input-sm arg-input svelte-1jugud0" placeholder="Unknown kind">'),Ge=m('<label class="arg-label svelte-1jugud0"><div><!> <span class="arg-type svelte-1jugud0"> </span></div> <!></label>');function Qe(G,e){fe(e,!0);const[F,V]=pe(),v=()=>me(be,"$LL",F);let i=ae(e,"value",15);const x=_e({nsec:{value:1,label:v().remote_actions.units.nsec()},µsec:{value:1e3,label:v().remote_actions.units.usec()},msec:{value:1e6,label:v().remote_actions.units.msec()},sec:{value:1e9,label:v().remote_actions.units.sec()},min:{value:60*1e9,label:v().remote_actions.units.min()},hour:{value:3600*1e9,label:v().remote_actions.units.hour()},day:{value:86400*1e9,label:v().remote_actions.units.day()},week:{value:7*86400*1e9,label:v().remote_actions.units.week()},month:{value:30*86400*1e9,label:v().remote_actions.units.month()},year:{value:365*86400*1e9,label:v().remote_actions.units.year()}}),J=Object.keys(x);function H(a,l){const _=x[l].value;return typeof a!="number"||isNaN(a)||!_?0:Math.round(a*_)}let b=z(0),k=z("sec"),u=je(()=>e.arg.kind==="duration");re(()=>{if(t(u)){const a=H(t(b),t(k));a!==i()&&i(a)}});var y=Ge(),d=o(y),w=o(d);{var U=a=>{var l=Ue(),_=we(l),L=o(_,!0);n(_),Ne(2),p(()=>j(L,e.arg.name)),c(a,l)};O(w,a=>{e.arg.name&&a(U)})}var Y=S(w,2),N=o(Y,!0);n(Y),n(d);var B=S(d,2);{var Q=a=>{var l=Be();X(l),p(()=>l.disabled=e.loading),$(l,i),c(a,l)},W=(a,l)=>{{var _=f=>{var g=Me();X(g),p(()=>g.disabled=e.loading),$(g,i),c(f,g)},L=(f,g)=>{{var M=P=>{var q=qe();X(q),p(()=>q.disabled=e.loading),$(q,i),c(P,q)},D=(P,q)=>{{var ie=E=>{var K=Ce();X(K),p(()=>K.disabled=e.loading),Fe(K,i),c(E,K)},le=(E,K)=>{{var oe=C=>{var R=He();X(R),p(()=>R.disabled=e.loading),$(R,i),c(C,R)},ue=(C,R)=>{{var ce=s=>{var r=Re(),h=o(r);X(h);var I=S(h,2);se(I,21,()=>J,ne,(T,Z)=>{var ee=Ke(),ye={},Oe=o(ee,!0);n(ee),p(()=>{ye!==(ye=t(Z))&&(ee.value=(ee.__value=t(Z))==null?"":t(Z)),j(Oe,x[t(Z)].label)}),c(T,ee)}),n(I),n(r),p(()=>{h.disabled=e.loading,I.disabled=e.loading}),$(h,()=>t(b),T=>A(b,T)),Je(I,()=>t(k),T=>A(k,T)),c(s,r)},ve=s=>{var r=ze();X(r),p(()=>r.disabled=e.loading),$(r,i),c(s,r)};O(C,s=>{e.arg.kind==="duration"?s(ce):s(ve,!1)},R)}};O(E,C=>{e.arg.kind==="time"?C(oe):C(ue,!1)},K)}};O(P,E=>{e.arg.kind==="bool"?E(ie):E(le,!1)},q)}};O(f,P=>{e.arg.kind==="float"||e.arg.kind==="float32"||e.arg.kind==="float64"?P(M):P(D,!1)},g)}};O(a,f=>{e.arg.kind==="int"||e.arg.kind==="int8"||e.arg.kind==="int16"||e.arg.kind==="int32"||e.arg.kind==="int64"||e.arg.kind==="uint"||e.arg.kind==="uint8"||e.arg.kind==="uint16"||e.arg.kind==="uint32"||e.arg.kind==="uint64"?f(_):f(L,!1)},l)}};O(B,a=>{e.arg.kind==="text"?a(Q):a(W,!1)})}n(y),p(()=>j(N,e.arg.type)),c(G,y),ge(),V()}async function We(G,e,F,V,v,i,x,J,H){var k;if(!t(e))return;A(F,!0),A(V,null),A(v,null);const b=t(i).args.map((u,y)=>{const d=x[y];return J(d,u.kind)});try{const[u,y]=await Le.invokeAction(t(H),b);if(y)throw y;u&&u.error?A(v,u.error,!0):u?A(V,u.result,!0):A(v,"Received unexpected null response")}catch(u){A(v,((k=u.response)==null?void 0:k.data)||u.message||`Failed to invoke action '${t(H)}'`,!0)}finally{A(F,!1)}}var Xe=m('<p class="action-description svelte-fausyb"> </p>'),Ye=m('<div class="args-container svelte-fausyb"></div>'),Ze=m('<p class="no-args-message svelte-fausyb"> </p>'),$e=m('<div class="output-box error-display svelte-fausyb"><pre class="svelte-fausyb"> </pre></div>'),et=m('<div class="output-box result-box svelte-fausyb"><pre class="svelte-fausyb"> </pre></div>'),tt=m('<div class="action-node svelte-fausyb"><div class="action-header svelte-fausyb"><div class="action-icon svelte-fausyb">♦</div> <span class="action-name svelte-fausyb"> </span></div> <!> <div class="action-body svelte-fausyb"><div class="input-row svelte-fausyb"><!> <button class="btn btn-sm invoke-button variant-ghost-primary svelte-fausyb"><!></button></div> <!> <!></div></div>'),at=m('<details class="directory-node svelte-fausyb"><summary class="directory-summary list-item svelte-fausyb"><span class="directory-icon svelte-fausyb"></span> <span class="directory-name svelte-fausyb"> </span></summary> <div class="directory-content svelte-fausyb"></div></details>');function Ae(G,e){fe(e,!0);const[F,V]=pe(),v=()=>me(be,"$LL",F);let i=ae(e,"name",3,""),x=ae(e,"node",19,()=>({})),J=ae(e,"currentPath",3,""),H=ae(e,"isOpen",3,!1),b=z(null),k=z(null),u=z(!1),y=z(!1);re(()=>{A(y,x()&&x()._isAction===!0,!0)});let d=z(_e({args:[],description:""}));re(()=>{A(d,t(y)?x().details:{args:[],description:""},!0)});let w=z("");re(()=>{A(w,J()?`${J()}/${i()}`:i(),!0)});let U=_e({});function Y(a,l){switch(l){case"int":const _=parseInt(a,10);return isNaN(_)?0:_;case"float":const L=parseFloat(a);return isNaN(L)?0:L;case"bool":return!!a;case"time":const f=new Date(a);return isNaN(f)?new Date(0):f;case"duration":return typeof a!="number"||isNaN(a)?0:a;case"text":default:return a==null?"":String(a)}}var N=Pe(),B=we(N);{var Q=a=>{var l=tt(),_=o(l),L=S(o(_),2),f=o(L,!0);n(L),n(_);var g=S(_,2);{var M=s=>{var r=Xe(),h=o(r,!0);n(r),p(()=>j(h,t(d).description)),c(s,r)};O(g,s=>{t(d).description&&s(M)})}var D=S(g,2),P=o(D),q=o(P);{var ie=s=>{var r=Ye();se(r,21,()=>t(d).args,ne,(h,I,T)=>{Qe(h,{get arg(){return t(I)},get loading(){return t(u)},get value(){return U[T]},set value(Z){U[T]=Z}})}),n(r),c(s,r)},le=s=>{var r=Ze(),h=o(r,!0);n(r),p(I=>j(h,I),[()=>v().remote_actions.no_args()]),c(s,r)};O(q,s=>{t(d).args&&t(d).args.length>0?s(ie):s(le,!1)})}var E=S(q,2);E.__click=[We,y,u,b,k,d,U,Y,w];var K=o(E);{var oe=s=>{var r=ke("...");c(s,r)},ue=s=>{var r=ke();p(h=>j(r,h),[()=>v().remote_actions.invoke()]),c(s,r)};O(K,s=>{t(u)?s(oe):s(ue,!1)})}n(E),n(P);var C=S(P,2);{var R=s=>{var r=$e(),h=o(r),I=o(h,!0);n(h),n(r),p(()=>j(I,t(k))),c(s,r)};O(C,s=>{t(k)&&s(R)})}var ce=S(C,2);{var ve=s=>{var r=et(),h=o(r),I=o(h,!0);n(h),n(r),p(T=>j(I,T),[()=>typeof t(b)=="string"?t(b):JSON.stringify(t(b),null,2)]),c(s,r)};O(ce,s=>{t(b)!==null&&s(ve)})}n(D),n(l),p(()=>{j(f,i()),E.disabled=t(u)}),c(a,l)},W=a=>{var l=at(),_=o(l),L=S(o(_),2),f=o(L,!0);n(L),n(_);var g=S(_,2);se(g,21,()=>x().childrenOrder,ne,(M,D)=>{Ae(M,{get name(){return t(D)},get node(){return x().children[t(D)]},get currentPath(){return t(w)}})}),n(g),n(l),p(()=>{l.open=H(),j(f,i())}),c(a,l)};O(B,a=>{t(y)?a(Q):a(W,!1)})}c(G,N),ge(),V()}Ve(["click"]);var rt=m('<div class="status-message svelte-wo54k"> </div>'),st=m('<div class="status-message error svelte-wo54k"><strong class="svelte-wo54k"> </strong> </div>'),nt=m('<div class="status-message svelte-wo54k"> </div>'),it=m('<div class="actions-tree svelte-wo54k"></div>'),lt=m('<div class="actions-page svelte-wo54k"><h1 class="page-title svelte-wo54k"> </h1> <!></div>');function wt(G,e){fe(e,!1);const[F,V]=pe(),v=()=>me(be,"$LL",F);let i=de({}),x=de(!0),J=de(null);Se(async()=>{try{const[b,k]=await Le.getActions();if(k)throw k;A(i,b?H(b):{})}catch(b){A(J,b.message||"Failed to load actions")}finally{A(x,!1)}});function H(b){const k={children:{},childrenOrder:[]};return b.forEach(u=>{const y=u.path.split("/");let d=k;y.forEach((w,U)=>{U===y.length-1?(d.children[w]={_isAction:!0,details:{args:u.args,description:u.description}},d.childrenOrder.includes(w)||d.childrenOrder.push(w)):(d.children[w]||(d.children[w]={children:{},childrenOrder:[]},d.childrenOrder.push(w)),d=d.children[w])})}),k}Ie(),Ee(G,{children:(b,k)=>{var u=lt(),y=o(u),d=o(y,!0);n(y);var w=S(y,2);{var U=N=>{var B=rt(),Q=o(B,!0);n(B),p(W=>j(Q,W),[()=>v().remote_actions.loading()],te),c(N,B)},Y=(N,B)=>{{var Q=a=>{var l=st(),_=o(l),L=o(_);n(_);var f=S(_);n(l),p(g=>{j(L,`${g??""}:`),j(f,` ${t(J)??""}`)},[()=>v().remote_actions.error()],te),c(a,l)},W=(a,l)=>{{var _=f=>{var g=nt(),M=o(g,!0);n(g),p(D=>j(M,D),[()=>v().remote_actions.no_actions()],te),c(f,g)},L=f=>{var g=it();se(g,5,()=>t(i).childrenOrder,ne,(M,D)=>{const P=te(()=>t(i).childrenOrder.length<=2);Ae(M,{get name(){return t(D)},get node(){return t(i).children[t(D)]},currentPath:"",get isOpen(){return t(P)}})}),n(g),c(f,g)};O(a,f=>{Object.keys(t(i).children||{}).length===0?f(_):f(L,!1)},l)}};O(N,a=>{t(J)?a(Q):a(W,!1)},B)}};O(w,N=>{t(x)?N(U):N(Y,!1)})}n(u),p(N=>j(d,N),[()=>v().remote_actions.title()],te),c(b,u)},$$slots:{default:!0}}),ge(),V()}export{wt as component};
